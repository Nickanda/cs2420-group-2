Teacher:
Epoch 1/20
/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:591: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
Teacher Train Loss: 0.9661, Train Acc: 0.6752
Epoch 2/20
Teacher Train Loss: 0.6564, Train Acc: 0.7773
Epoch 3/20
Teacher Train Loss: 0.5101, Train Acc: 0.8277
Epoch 4/20
Teacher Train Loss: 0.4325, Train Acc: 0.8551
Epoch 5/20
Teacher Train Loss: 0.3500, Train Acc: 0.8818
Epoch 6/20
Teacher Train Loss: 0.2655, Train Acc: 0.9097
Epoch 7/20
Teacher Train Loss: 0.2215, Train Acc: 0.9263
Epoch 8/20
Teacher Train Loss: 0.1803, Train Acc: 0.9386
Epoch 9/20
Teacher Train Loss: 0.1504, Train Acc: 0.9496
Epoch 10/20
Teacher Train Loss: 0.1299, Train Acc: 0.9556
Epoch 11/20
Teacher Train Loss: 0.1049, Train Acc: 0.9636
Epoch 12/20
Teacher Train Loss: 0.0949, Train Acc: 0.9686
Epoch 13/20
Teacher Train Loss: 0.1080, Train Acc: 0.9640
Epoch 14/20
Teacher Train Loss: 0.0795, Train Acc: 0.9731
Epoch 15/20
Teacher Train Loss: 0.0805, Train Acc: 0.9744
Epoch 16/20
Teacher Train Loss: 0.1078, Train Acc: 0.9645
Epoch 17/20
Teacher Train Loss: 0.0541, Train Acc: 0.9818
Epoch 18/20
Teacher Train Loss: 0.0579, Train Acc: 0.9810
Epoch 19/20
Teacher Train Loss: 0.0732, Train Acc: 0.9760
Epoch 20/20
Teacher Train Loss: 0.0501, Train Acc: 0.9831

Distilling Student 1:
Distill Loss: 6.5840
\Training Student 1:
Epoch 1/20
Student 1 Train Loss: 0.9594, Train Acc: 0.6632
Epoch 2/20
Student 1 Train Loss: 0.8404, Train Acc: 0.7060
Epoch 3/20
Student 1 Train Loss: 0.7514, Train Acc: 0.7358
Epoch 4/20
Student 1 Train Loss: 0.6514, Train Acc: 0.7714
Epoch 5/20
Student 1 Train Loss: 0.5441, Train Acc: 0.8108
Epoch 6/20
Student 1 Train Loss: 0.4414, Train Acc: 0.8468
Epoch 7/20
Student 1 Train Loss: 0.3373, Train Acc: 0.8827
Epoch 8/20
Student 1 Train Loss: 0.2493, Train Acc: 0.9145
Epoch 9/20
Student 1 Train Loss: 0.1772, Train Acc: 0.9397
Epoch 10/20
Student 1 Train Loss: 0.1246, Train Acc: 0.9579
Epoch 11/20
Student 1 Train Loss: 0.0993, Train Acc: 0.9664
Epoch 12/20
Student 1 Train Loss: 0.0918, Train Acc: 0.9684
Epoch 13/20
Student 1 Train Loss: 0.0738, Train Acc: 0.9747
Epoch 14/20
Student 1 Train Loss: 0.0706, Train Acc: 0.9761
Epoch 15/20
Student 1 Train Loss: 0.0701, Train Acc: 0.9761
Epoch 16/20
Student 1 Train Loss: 0.0539, Train Acc: 0.9819
Epoch 17/20
Student 1 Train Loss: 0.0621, Train Acc: 0.9779
Epoch 18/20
Student 1 Train Loss: 0.0543, Train Acc: 0.9812
Epoch 19/20
Student 1 Train Loss: 0.0450, Train Acc: 0.9847
Epoch 20/20
Student 1 Train Loss: 0.0528, Train Acc: 0.9817

Distilling Student 2:
Distill Loss: 6.3833
\Training Student 2:
Epoch 1/20
Student 2 Train Loss: 0.9366, Train Acc: 0.6718
Epoch 2/20
Student 2 Train Loss: 0.8311, Train Acc: 0.7099
Epoch 3/20
Student 2 Train Loss: 0.7402, Train Acc: 0.7380
Epoch 4/20
Student 2 Train Loss: 0.6361, Train Acc: 0.7788
Epoch 5/20
Student 2 Train Loss: 0.5232, Train Acc: 0.8179
Epoch 6/20
Student 2 Train Loss: 0.4117, Train Acc: 0.8559
Epoch 7/20
Student 2 Train Loss: 0.3056, Train Acc: 0.8938
Epoch 8/20
Student 2 Train Loss: 0.2139, Train Acc: 0.9270
Epoch 9/20
Student 2 Train Loss: 0.1554, Train Acc: 0.9465
Epoch 10/20
Student 2 Train Loss: 0.1151, Train Acc: 0.9609
Epoch 11/20
Student 2 Train Loss: 0.1020, Train Acc: 0.9645
Epoch 12/20
Student 2 Train Loss: 0.0820, Train Acc: 0.9716
Epoch 13/20
Student 2 Train Loss: 0.0695, Train Acc: 0.9763
Epoch 14/20
Student 2 Train Loss: 0.0763, Train Acc: 0.9743
Epoch 15/20
Student 2 Train Loss: 0.0644, Train Acc: 0.9783
Epoch 16/20
Student 2 Train Loss: 0.0646, Train Acc: 0.9785
Epoch 17/20
Student 2 Train Loss: 0.0647, Train Acc: 0.9781
Epoch 18/20
Student 2 Train Loss: 0.0428, Train Acc: 0.9853
Epoch 19/20
Student 2 Train Loss: 0.0533, Train Acc: 0.9823
Epoch 20/20
Student 2 Train Loss: 0.0502, Train Acc: 0.9830

Distilling Student 3:
Distill Loss: 6.4042
\Training Student 3:
Epoch 1/20
Student 3 Train Loss: 0.9325, Train Acc: 0.6726
Epoch 2/20
Student 3 Train Loss: 0.8275, Train Acc: 0.7097
Epoch 3/20
Student 3 Train Loss: 0.7388, Train Acc: 0.7423
Epoch 4/20
Student 3 Train Loss: 0.6361, Train Acc: 0.7778
Epoch 5/20
Student 3 Train Loss: 0.5335, Train Acc: 0.8153
Epoch 6/20
Student 3 Train Loss: 0.4272, Train Acc: 0.8529
Epoch 7/20
Student 3 Train Loss: 0.3297, Train Acc: 0.8861
Epoch 8/20
Student 3 Train Loss: 0.2409, Train Acc: 0.9169
Epoch 9/20
Student 3 Train Loss: 0.1641, Train Acc: 0.9430
Epoch 10/20
Student 3 Train Loss: 0.1247, Train Acc: 0.9578
Epoch 11/20
Student 3 Train Loss: 0.0983, Train Acc: 0.9668
Epoch 12/20
Student 3 Train Loss: 0.0885, Train Acc: 0.9696
Epoch 13/20
Student 3 Train Loss: 0.0779, Train Acc: 0.9730
Epoch 14/20
Student 3 Train Loss: 0.0685, Train Acc: 0.9767
Epoch 15/20
Student 3 Train Loss: 0.0681, Train Acc: 0.9766
Epoch 16/20
Student 3 Train Loss: 0.0597, Train Acc: 0.9795
Epoch 17/20
Student 3 Train Loss: 0.0569, Train Acc: 0.9804
Epoch 18/20
Student 3 Train Loss: 0.0473, Train Acc: 0.9841
Epoch 19/20
Student 3 Train Loss: 0.0546, Train Acc: 0.9811
Epoch 20/20
Student 3 Train Loss: 0.0518, Train Acc: 0.9817

Distilling Student 4:
Distill Loss: 6.4906
\Training Student 4:
Epoch 1/20
Student 4 Train Loss: 0.9488, Train Acc: 0.6698
Epoch 2/20
Student 4 Train Loss: 0.8385, Train Acc: 0.7063
Epoch 3/20
Student 4 Train Loss: 0.7503, Train Acc: 0.7381
Epoch 4/20
Student 4 Train Loss: 0.6514, Train Acc: 0.7721
Epoch 5/20
Student 4 Train Loss: 0.5416, Train Acc: 0.8119
Epoch 6/20
Student 4 Train Loss: 0.4247, Train Acc: 0.8525
Epoch 7/20
Student 4 Train Loss: 0.3292, Train Acc: 0.8859
Epoch 8/20
Student 4 Train Loss: 0.2356, Train Acc: 0.9180
Epoch 9/20
Student 4 Train Loss: 0.1681, Train Acc: 0.9426
Epoch 10/20
Student 4 Train Loss: 0.1219, Train Acc: 0.9591
Epoch 11/20
Student 4 Train Loss: 0.1007, Train Acc: 0.9659
Epoch 12/20
Student 4 Train Loss: 0.0818, Train Acc: 0.9717
Epoch 13/20
Student 4 Train Loss: 0.0830, Train Acc: 0.9708
Epoch 14/20
Student 4 Train Loss: 0.0705, Train Acc: 0.9754
Epoch 15/20
Student 4 Train Loss: 0.0526, Train Acc: 0.9824
Epoch 16/20
Student 4 Train Loss: 0.0700, Train Acc: 0.9769
Epoch 17/20
Student 4 Train Loss: 0.0528, Train Acc: 0.9816
Epoch 18/20
Student 4 Train Loss: 0.0488, Train Acc: 0.9835
Epoch 19/20
Student 4 Train Loss: 0.0543, Train Acc: 0.9810
Epoch 20/20
Student 4 Train Loss: 0.0445, Train Acc: 0.9850
\Teacher model:
WARNING:fvcore.nn.jit_analysis:Unsupported operator aten::max_pool2d encountered 1 time(s)
WARNING:fvcore.nn.jit_analysis:Unsupported operator aten::add_ encountered 8 time(s)
Teacher Results:
Loss: 0.9153, Accuracy: 0.8022
Latency per Image: 0.002638 secs
FLOPs per Image: 0.58 MFLOPs
\MoE Model:
WARNING:fvcore.nn.jit_analysis:Unsupported operator aten::max_pool2d encountered 2 time(s)
WARNING:fvcore.nn.jit_analysis:The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
gating_net, gating_net.gate, students.0, students.0.network, students.0.network.0, students.0.network.1, students.0.network.2, students.0.network.3, students.0.network.4, students.0.network.5, students.0.network.6, students.0.network.7, students.0.network.8, students.0.network.9, students.2, students.2.network, students.2.network.0, students.2.network.1, students.2.network.2, students.2.network.3, students.2.network.4, students.2.network.5, students.2.network.6, students.2.network.7, students.2.network.8, students.2.network.9, students.3, students.3.network, students.3.network.0, students.3.network.1, students.3.network.2, students.3.network.3, students.3.network.4, students.3.network.5, students.3.network.6, students.3.network.7, students.3.network.8, students.3.network.9
MoE Results:
Loss: 2.1949, Accuracy: 0.7082
Latency per Image: 0.000817 secs
FLOPs per Image: 0.10 MFLOPs
