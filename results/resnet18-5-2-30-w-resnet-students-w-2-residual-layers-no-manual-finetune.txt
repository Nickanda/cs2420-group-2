Teacher:
Epoch 1/30
Teacher Train Loss: 0.9724, Train Acc: 0.6703
Epoch 2/30
Teacher Train Loss: 0.6499, Train Acc: 0.7817
Epoch 3/30
Teacher Train Loss: 0.5401, Train Acc: 0.8184
Epoch 4/30
Teacher Train Loss: 0.4123, Train Acc: 0.8593
Epoch 5/30
Teacher Train Loss: 0.3354, Train Acc: 0.8864
Epoch 6/30
Teacher Train Loss: 0.2856, Train Acc: 0.9036
Epoch 7/30
Teacher Train Loss: 0.1974, Train Acc: 0.9331
Epoch 8/30
Teacher Train Loss: 0.1875, Train Acc: 0.9374
Epoch 9/30
Teacher Train Loss: 0.1530, Train Acc: 0.9491
Epoch 10/30
Teacher Train Loss: 0.1276, Train Acc: 0.9561
Epoch 11/30
Teacher Train Loss: 0.1158, Train Acc: 0.9603
Epoch 12/30
Teacher Train Loss: 0.0872, Train Acc: 0.9700
Epoch 13/30
Teacher Train Loss: 0.0828, Train Acc: 0.9718
Epoch 14/30
Teacher Train Loss: 0.0804, Train Acc: 0.9733
Epoch 15/30
Teacher Train Loss: 0.0754, Train Acc: 0.9742
Epoch 16/30
Teacher Train Loss: 0.0835, Train Acc: 0.9724
Epoch 17/30
Teacher Train Loss: 0.0666, Train Acc: 0.9783
Epoch 18/30
Teacher Train Loss: 0.0581, Train Acc: 0.9797
Epoch 19/30
Teacher Train Loss: 0.0603, Train Acc: 0.9804
Epoch 20/30
Teacher Train Loss: 0.0557, Train Acc: 0.9812
Epoch 21/30
Teacher Train Loss: 0.0541, Train Acc: 0.9820
Epoch 22/30
Teacher Train Loss: 0.0554, Train Acc: 0.9816
Epoch 23/30
Teacher Train Loss: 0.0439, Train Acc: 0.9855
Epoch 24/30
Teacher Train Loss: 0.0471, Train Acc: 0.9840
Epoch 25/30
Teacher Train Loss: 0.0447, Train Acc: 0.9850
Epoch 26/30
Teacher Train Loss: 0.0497, Train Acc: 0.9837
Epoch 27/30
Teacher Train Loss: 0.0482, Train Acc: 0.9836
Epoch 28/30
Teacher Train Loss: 0.0302, Train Acc: 0.9900
Epoch 29/30
Teacher Train Loss: 0.0537, Train Acc: 0.9821
Epoch 30/30
Teacher Train Loss: 0.0333, Train Acc: 0.9887

Distilling Student 1:
Distill Loss: 7.7056

Training Student 1:
Epoch 1/30
Student 1 Train Loss: 1.0582, Train Acc: 0.6275
Epoch 2/30
Student 1 Train Loss: 0.9488, Train Acc: 0.6633
Epoch 3/30
Student 1 Train Loss: 0.8611, Train Acc: 0.6953
Epoch 4/30
Student 1 Train Loss: 0.7718, Train Acc: 0.7272
Epoch 5/30
Student 1 Train Loss: 0.6773, Train Acc: 0.7606
Epoch 6/30
Student 1 Train Loss: 0.5888, Train Acc: 0.7922
Epoch 7/30
Student 1 Train Loss: 0.4953, Train Acc: 0.8232
Epoch 8/30
Student 1 Train Loss: 0.4111, Train Acc: 0.8543
Epoch 9/30
Student 1 Train Loss: 0.3317, Train Acc: 0.8837
Epoch 10/30
Student 1 Train Loss: 0.2599, Train Acc: 0.9077
Epoch 11/30
Student 1 Train Loss: 0.2034, Train Acc: 0.9276
Epoch 12/30
Student 1 Train Loss: 0.1622, Train Acc: 0.9438
Epoch 13/30
Student 1 Train Loss: 0.1283, Train Acc: 0.9550
Epoch 14/30
Student 1 Train Loss: 0.1183, Train Acc: 0.9584
Epoch 15/30
Student 1 Train Loss: 0.1068, Train Acc: 0.9631
Epoch 16/30
Student 1 Train Loss: 0.0989, Train Acc: 0.9651
Epoch 17/30
Student 1 Train Loss: 0.0859, Train Acc: 0.9698
Epoch 18/30
Student 1 Train Loss: 0.0802, Train Acc: 0.9728
Epoch 19/30
Student 1 Train Loss: 0.0908, Train Acc: 0.9689
Epoch 20/30
Student 1 Train Loss: 0.0632, Train Acc: 0.9778
Epoch 21/30
Student 1 Train Loss: 0.0756, Train Acc: 0.9741
Epoch 22/30
Student 1 Train Loss: 0.0594, Train Acc: 0.9798
Epoch 23/30
Student 1 Train Loss: 0.0629, Train Acc: 0.9782
Epoch 24/30
Student 1 Train Loss: 0.0588, Train Acc: 0.9802
Epoch 25/30
Student 1 Train Loss: 0.0610, Train Acc: 0.9790
Epoch 26/30
Student 1 Train Loss: 0.0772, Train Acc: 0.9740
Epoch 27/30
Student 1 Train Loss: 0.0475, Train Acc: 0.9838
Epoch 28/30
Student 1 Train Loss: 0.0546, Train Acc: 0.9817
Epoch 29/30
Student 1 Train Loss: 0.0465, Train Acc: 0.9839
Epoch 30/30
Student 1 Train Loss: 0.0643, Train Acc: 0.9787

Distilling Student 2:
Distill Loss: 7.5561

Training Student 2:
Epoch 1/30
Student 2 Train Loss: 1.0475, Train Acc: 0.6326
Epoch 2/30
Student 2 Train Loss: 0.9417, Train Acc: 0.6654
Epoch 3/30
Student 2 Train Loss: 0.8514, Train Acc: 0.6998
Epoch 4/30
Student 2 Train Loss: 0.7693, Train Acc: 0.7288
Epoch 5/30
Student 2 Train Loss: 0.6749, Train Acc: 0.7618
Epoch 6/30
Student 2 Train Loss: 0.5849, Train Acc: 0.7934
Epoch 7/30
Student 2 Train Loss: 0.4971, Train Acc: 0.8262
Epoch 8/30
Student 2 Train Loss: 0.4066, Train Acc: 0.8567
Epoch 9/30
Student 2 Train Loss: 0.3256, Train Acc: 0.8870
Epoch 10/30
Student 2 Train Loss: 0.2542, Train Acc: 0.9109
Epoch 11/30
Student 2 Train Loss: 0.2002, Train Acc: 0.9290
Epoch 12/30
Student 2 Train Loss: 0.1667, Train Acc: 0.9415
Epoch 13/30
Student 2 Train Loss: 0.1385, Train Acc: 0.9518
Epoch 14/30
Student 2 Train Loss: 0.1159, Train Acc: 0.9597
Epoch 15/30
Student 2 Train Loss: 0.1028, Train Acc: 0.9631
Epoch 16/30
Student 2 Train Loss: 0.0881, Train Acc: 0.9688
Epoch 17/30
Student 2 Train Loss: 0.0894, Train Acc: 0.9702
Epoch 18/30
Student 2 Train Loss: 0.0883, Train Acc: 0.9697
Epoch 19/30
Student 2 Train Loss: 0.0802, Train Acc: 0.9722
Epoch 20/30
Student 2 Train Loss: 0.0702, Train Acc: 0.9754
Epoch 21/30
Student 2 Train Loss: 0.0666, Train Acc: 0.9776
Epoch 22/30
Student 2 Train Loss: 0.0678, Train Acc: 0.9764
Epoch 23/30
Student 2 Train Loss: 0.0693, Train Acc: 0.9762
Epoch 24/30
Student 2 Train Loss: 0.0557, Train Acc: 0.9805
Epoch 25/30
Student 2 Train Loss: 0.0604, Train Acc: 0.9799
Epoch 26/30
Student 2 Train Loss: 0.0583, Train Acc: 0.9807
Epoch 27/30
Student 2 Train Loss: 0.0520, Train Acc: 0.9826
Epoch 28/30
Student 2 Train Loss: 0.0554, Train Acc: 0.9813
Epoch 29/30
Student 2 Train Loss: 0.0505, Train Acc: 0.9831
Epoch 30/30
Student 2 Train Loss: 0.0469, Train Acc: 0.9838

Distilling Student 3:
Distill Loss: 7.6087

Training Student 3:
Epoch 1/30
Student 3 Train Loss: 1.0517, Train Acc: 0.6308
Epoch 2/30
Student 3 Train Loss: 0.9345, Train Acc: 0.6700
Epoch 3/30
Student 3 Train Loss: 0.8500, Train Acc: 0.6997
Epoch 4/30
Student 3 Train Loss: 0.7592, Train Acc: 0.7321
Epoch 5/30
Student 3 Train Loss: 0.6666, Train Acc: 0.7642
Epoch 6/30
Student 3 Train Loss: 0.5767, Train Acc: 0.7962
Epoch 7/30
Student 3 Train Loss: 0.4857, Train Acc: 0.8298
Epoch 8/30
Student 3 Train Loss: 0.3950, Train Acc: 0.8611
Epoch 9/30
Student 3 Train Loss: 0.3099, Train Acc: 0.8911
Epoch 10/30
Student 3 Train Loss: 0.2385, Train Acc: 0.9161
Epoch 11/30
Student 3 Train Loss: 0.1917, Train Acc: 0.9315
Epoch 12/30
Student 3 Train Loss: 0.1485, Train Acc: 0.9471
Epoch 13/30
Student 3 Train Loss: 0.1290, Train Acc: 0.9552
Epoch 14/30
Student 3 Train Loss: 0.1142, Train Acc: 0.9599
Epoch 15/30
Student 3 Train Loss: 0.0995, Train Acc: 0.9655
Epoch 16/30
Student 3 Train Loss: 0.0898, Train Acc: 0.9685
Epoch 17/30
Student 3 Train Loss: 0.0907, Train Acc: 0.9687
Epoch 18/30
Student 3 Train Loss: 0.0770, Train Acc: 0.9730
Epoch 19/30
Student 3 Train Loss: 0.0738, Train Acc: 0.9746
Epoch 20/30
Student 3 Train Loss: 0.0808, Train Acc: 0.9722
Epoch 21/30
Student 3 Train Loss: 0.0598, Train Acc: 0.9799
Epoch 22/30
Student 3 Train Loss: 0.0604, Train Acc: 0.9791
Epoch 23/30
Student 3 Train Loss: 0.0737, Train Acc: 0.9753
Epoch 24/30
Student 3 Train Loss: 0.0613, Train Acc: 0.9794
Epoch 25/30
Student 3 Train Loss: 0.0494, Train Acc: 0.9828
Epoch 26/30
Student 3 Train Loss: 0.0574, Train Acc: 0.9806
Epoch 27/30
Student 3 Train Loss: 0.0615, Train Acc: 0.9794
Epoch 28/30
Student 3 Train Loss: 0.0473, Train Acc: 0.9840
Epoch 29/30
Student 3 Train Loss: 0.0546, Train Acc: 0.9817
Epoch 30/30
Student 3 Train Loss: 0.0504, Train Acc: 0.9827

Distilling Student 4:
Distill Loss: 7.8094

Training Student 4:
Epoch 1/30
Student 4 Train Loss: 1.0698, Train Acc: 0.6224
Epoch 2/30
Student 4 Train Loss: 0.9609, Train Acc: 0.6609
Epoch 3/30
Student 4 Train Loss: 0.8733, Train Acc: 0.6881
Epoch 4/30
Student 4 Train Loss: 0.7925, Train Acc: 0.7198
Epoch 5/30
Student 4 Train Loss: 0.7069, Train Acc: 0.7479
Epoch 6/30
Student 4 Train Loss: 0.6187, Train Acc: 0.7840
Epoch 7/30
Student 4 Train Loss: 0.5346, Train Acc: 0.8118
Epoch 8/30
Student 4 Train Loss: 0.4543, Train Acc: 0.8423
Epoch 9/30
Student 4 Train Loss: 0.3711, Train Acc: 0.8687
Epoch 10/30
Student 4 Train Loss: 0.3040, Train Acc: 0.8927
Epoch 11/30
Student 4 Train Loss: 0.2477, Train Acc: 0.9138
Epoch 12/30
Student 4 Train Loss: 0.1985, Train Acc: 0.9302
Epoch 13/30
Student 4 Train Loss: 0.1601, Train Acc: 0.9431
Epoch 14/30
Student 4 Train Loss: 0.1373, Train Acc: 0.9523
Epoch 15/30
Student 4 Train Loss: 0.1276, Train Acc: 0.9552
Epoch 16/30
Student 4 Train Loss: 0.1056, Train Acc: 0.9631
Epoch 17/30
Student 4 Train Loss: 0.1001, Train Acc: 0.9648
Epoch 18/30
Student 4 Train Loss: 0.0929, Train Acc: 0.9678
Epoch 19/30
Student 4 Train Loss: 0.0889, Train Acc: 0.9689
Epoch 20/30
Student 4 Train Loss: 0.0808, Train Acc: 0.9721
Epoch 21/30
Student 4 Train Loss: 0.0828, Train Acc: 0.9712
Epoch 22/30
Student 4 Train Loss: 0.0789, Train Acc: 0.9732
Epoch 23/30
Student 4 Train Loss: 0.0698, Train Acc: 0.9760
Epoch 24/30
Student 4 Train Loss: 0.0672, Train Acc: 0.9766
Epoch 25/30
Student 4 Train Loss: 0.0670, Train Acc: 0.9778
Epoch 26/30
Student 4 Train Loss: 0.0654, Train Acc: 0.9781
Epoch 27/30
Student 4 Train Loss: 0.0606, Train Acc: 0.9796
Epoch 28/30
Student 4 Train Loss: 0.0619, Train Acc: 0.9792
Epoch 29/30
Student 4 Train Loss: 0.0618, Train Acc: 0.9788
Epoch 30/30
Student 4 Train Loss: 0.0513, Train Acc: 0.9828

Training MoE Model:
MoE Train Loss: 0.1605, Train Acc: 0.9524
MoE Train Loss: 0.1079, Train Acc: 0.9657
MoE Train Loss: 0.1068, Train Acc: 0.9670
MoE Train Loss: 0.1027, Train Acc: 0.9681
MoE Train Loss: 0.0830, Train Acc: 0.9734
MoE Train Loss: 0.0878, Train Acc: 0.9727
MoE Train Loss: 0.0812, Train Acc: 0.9753
MoE Train Loss: 0.0692, Train Acc: 0.9784
MoE Train Loss: 0.0758, Train Acc: 0.9767
MoE Train Loss: 0.0732, Train Acc: 0.9773
MoE Train Loss: 0.0629, Train Acc: 0.9807
MoE Train Loss: 0.0578, Train Acc: 0.9827
MoE Train Loss: 0.0686, Train Acc: 0.9797
MoE Train Loss: 0.0600, Train Acc: 0.9817
MoE Train Loss: 0.0589, Train Acc: 0.9825
MoE Train Loss: 0.0466, Train Acc: 0.9852
MoE Train Loss: 0.0555, Train Acc: 0.9836
MoE Train Loss: 0.0638, Train Acc: 0.9806
MoE Train Loss: 0.0485, Train Acc: 0.9852
MoE Train Loss: 0.0468, Train Acc: 0.9854
MoE Train Loss: 0.0598, Train Acc: 0.9828
MoE Train Loss: 0.0514, Train Acc: 0.9847
MoE Train Loss: 0.0467, Train Acc: 0.9870
MoE Train Loss: 0.0516, Train Acc: 0.9855
MoE Train Loss: 0.0558, Train Acc: 0.9845
MoE Train Loss: 0.0429, Train Acc: 0.9879
MoE Train Loss: 0.0446, Train Acc: 0.9870
MoE Train Loss: 0.0459, Train Acc: 0.9871
MoE Train Loss: 0.0442, Train Acc: 0.9878
MoE Train Loss: 0.0491, Train Acc: 0.9858

Teacher model:
WARNING:fvcore.nn.jit_analysis:Unsupported operator aten::max_pool2d encountered 1 time(s)
WARNING:fvcore.nn.jit_analysis:Unsupported operator aten::add_ encountered 8 time(s)
Teacher Results:
Loss: 0.9584, Accuracy: 0.8126
Latency per Image: 0.003359 secs
FLOPs per Image: 0.58 MFLOPs

MoE Model:
WARNING:fvcore.nn.jit_analysis:Unsupported operator aten::max_pool2d encountered 2 time(s)
WARNING:fvcore.nn.jit_analysis:Unsupported operator aten::add encountered 1 time(s)
WARNING:fvcore.nn.jit_analysis:The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
gating_net, students.1, students.1.conv1, students.1.conv2, students.1.conv3, students.1.downsample, students.1.fc1, students.1.fc2, students.1.pool, students.1.relu, students.2, students.2.conv1, students.2.conv2, students.2.conv3, students.2.downsample, students.2.fc1, students.2.fc2, students.2.pool, students.2.relu, students.3, students.3.conv1, students.3.conv2, students.3.conv3, students.3.downsample, students.3.fc1, students.3.fc2, students.3.pool, students.3.relu
MoE Results:
Loss: 4.1462, Accuracy: 0.6436
Latency per Image: 0.000867 secs
FLOPs per Image: 0.04 MFLOPs